!function(){var a=function(a){var b=this,c=function(){var b="",c=" ",d="\xa0",e="\n",f="data-type",g="data-value",h={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};a.fn.caret=function(a,b){if(0!=this.length){if("number"==typeof a)return b="number"==typeof b?b:a,this.each(function(){if(this.setSelectionRange){var c=this;window.setTimeout(function(){c.setSelectionRange(a,b)},0)}else if(this.createTextRange){var d=this.createTextRange();d.collapse(!0),d.moveEnd("character",b),d.moveStart("character",a);try{d.select()}catch(e){}}});if(this[0].setSelectionRange)a=this[0].selectionStart,b=this[0].selectionEnd;else if(document.selection&&document.selection.createRange){var c=document.selection.createRange();a=0-c.duplicate().moveStart("character",-1e5),b=a+c.text.length}return{start:a,end:b}}};var i=function(b){a.extend(this,b)};a.extend(i.prototype,{val:function(a){var b=this;return void 0===a?b.text.nodeValue:(b.text.nodeValue=a,b.end=b.start+(b.length=a.length),b)},nextSibling:function(a){for(var b=a.nextSibling;b&&1===b.nodeType&&b.hasAttribute("data-ignore");)b=b.nextSibling;return b},insert:function(f,g,h){var j=this,k=j.block,l=j.text,m=j.parent,n=j.br,o=j.val(),p=j.length,q=f==e,r=f==c,s=f==b,t=j.trigger||{},v=(t.finalize,j.finalized),w=32==o.charCodeAt(g-1),x=t.allowSpace||j.allowSpace,y=r&&(!x||x&&w);if(void 0===g&&(g=p),void 0===h&&(h=g),k&&w&&!x&&!v){if(r){var z=a(j.textarea),A=z.val(),B=z.caret().end-1,C=j.start+g;z.val(A.substring(0,C)+A.slice(C+1)).caret(B)}return j.toTextMarker(),r?(a(m).trigger("markerInsert",[j,K,f,g,h]),j):j.insert(f,g,h)}if(k&&h==p&&!s&&(y||q||n||v)){var D=j.spawn().insert(f,0);return a(m).trigger("markerExit",[j,K,D,f,g,h]),D}if(k&&0===j.index&&0===h&&1===f.length){var E=document.createTextNode(f);m.insertBefore(E,k);var F=new i({index:0,start:0,end:f.length,text:E,parent:m,textarea:j.textarea,allowSpace:!0});return a(m).trigger("markerInsert",[F,K,f,g,h]),F}var G=k?k.nextSibling:l.nextSibling,H=o.substring(0,g),I=o.slice(h),J=f.replace(/  /g," "+d).split(e),K=[],L=k||l,M=J.length;for(J[0]=H+J[0],J[M-1]+=I;--M;){var L=document.createTextNode(J[M]),n=document.createElement("BR");K.push(m.insertBefore(L,G)),K.push(m.insertBefore(n,L)),G=n}return j.val(J[M]),a(m).trigger("markerInsert",[j,K,f,g,h]),j},remove:function(){var b=this,c=b.parent,d=b.block,e=b.text;return d&&a(d).trigger("triggerDestroy",[b]),c.removeChild(d||e),b.removed=!0,a(c).trigger("markerRemove",[b]),b},toTextMarker:function(){var b=this,c=b.block,d=b.parent;if(!c)return b;var e=b.clone();return c&&a(c).trigger("triggerDestroy",[b]),d.insertBefore(b.text,c.nextSibling),d.removeChild(c),delete b.block,delete b.trigger,a(b.parent).trigger("markerConvert",[b,e,"text"]),b},toBlockMarker:function(){var c=this;if(!c.block){var d=c.clone(),e=c.parent,f=c.block=document.createElement("SPAN"),g=c.text;return e.insertBefore(f,g.nextSibling),f.appendChild(g),a(f).data("marker",{}),a(c.parent).trigger("markerConvert",[c,d,"block"]),c}},spawn:function(a,b){var c=this,d=c.text,e=c.parent,f=c.block,g=f?f.nextSibling:d.nextSibling;void 0===a&&(a=b=c.length),b<c.length&&(g=e.insertBefore(d.splitText(b),g)),d=e.insertBefore(d.splitText(a),g);var h=new i({index:c.index+1,start:a=c.start+a,end:b=c.start+b,length:b-a,text:d,parent:e,textarea:c.textarea,before:c,after:c.after,br:!1,allowSpace:!0,finalized:!1});return c.end=a,c.length=c.end-c.start,c.after=h,h},clone:function(){return new i(a.pick(this,"index,start,end,length,text,parent,textarea,before,after,br,allowSpace,trigger,value,finalized".split(",")))},finalize:function(b){var c=this,d=c.block;if(d){var e=a(d).data("marker");e.value=b,e.finalized=!0,a.extend(c,e)}},updateValue:function(b){var c=this,d=c.block;if(d){var e=a(d).data("marker");e.value=b,a.extend(c,e)}}}),a.Controller("Mentions",{pluginName:"mentions",hostname:"mentions",defaultOptions:{cssCloneProps:["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust"],triggers:{},"{textarea}":"[data-mentions-textarea]","{overlay}":"[data-mentions-overlay]","{block}":"[data-mentions-overlay] > span"}},function(b){return{init:function(){b._overlay=b.overlay()[0],b._textarea=b.textarea()[0],setTimeout(function(){b.cloneLayout()},15),b.addPlugin("autocomplete"),b.initialCaret=b.textarea().data("initial")||0},setLayout:function(){b.normalize()},cloneLayout:function(){for(var a=b.overlay(),c=a.detach()[0],d=b.textarea(),e=b.options.cssCloneProps,f=0;prop=e[f++];)c.style[prop]=d.css(prop);c.style.opacity=1,a.insertBefore(d),b.setLayout()},reset:function(){var c=b.overlay(),d=c.data("default");void 0!==d?c.html(a("<div>").html(d).html()):c.empty();var e=b.textarea(),f=e.data("default");void 0!==f?e.val(a("<div>").html(f).text()):e.val(""),b.caretBefore=b.caretAfter={start:0,end:0},b.previousMarker=null,b.normalize(),b.initialFocus=!0,b.trigger("triggerClear"),b.previousCursorPosition=0},moveCursor:function(a){b.textarea().trigger("focus"),b.textarea().caret(a)},getTrigger:function(a){var c=b.options.triggers;if(c.hasOwnProperty(a)){var d=c[a];return d.key=a,d}},getTriggerFromType:function(c){var e,d=b.options.triggers;return a.each(d,function(a,b){return b.type===c?(e=b,!1):void 0}),e},getStopIndex:function(a,b){for(var c=b.length,d=a.length;c--;){var e=b.substr(c,1),f=a.indexOf(e);d=0>f?d:Math.min(d,f)}return d},getMarkers:function(c){var k,d=b._textarea,h=b._overlay,j=a.makeArray(h.childNodes),l=0,m=0,n=null,o=!1,p=[],q=function(a){var b;return c&&(b=c.apply(a,[a])),null!==b&&b!==!1&&p.push(void 0!==b?b:a),b};for(a.remove(j,function(a){return 1===a.nodeType&&a.hasAttribute("data-ignore")});k=j[l++];){var t,v,w,r=k.nodeType,s=k.nodeName,u=null,x=!1,y=!1;if(3==r)t=k,y=!0;else if((u=k)&&"BR"==s)t=document.createTextNode(e),x=!0;else if(1!==r||"SPAN"!==s||!(t=k.childNodes[0])||3!==t.nodeType){h.removeChild(k);continue}var z={index:l-1,start:m,end:v=m+(w=t.length),length:w,text:t,block:u,parent:h,textarea:d,before:n,br:x,allowSpace:y,finalized:!1};if(u){var A=a(k),B=A.data("marker");if(B||(B={})&&A.data("marker",B),k.hasAttribute(f)){var C=A.attr(f),D=b.getTriggerFromType(C);D&&(B.trigger=D),A.removeAttr(f)}k.hasAttribute(g)&&(B.value=A.attr(g),B.finalized=!0,A.removeAttr(g)),a.extend(z,B)}var E=new i(z);if(l>1&&null!==n&&(n.after=E,o=q(n)===!1))break;m=v,n=E}return o||q(n),p},getMarkerAt:function(a){if(void 0!==a){var c;return b.getMarkers(function(){return a>=this.start&&a<=this.end?(c=this,!1):void 0}),c}},getMarkersBetween:function(a,c){return void 0!==a?b.getMarkers(function(){return this.start>c?!1:this.end<a?null:this}):void 0},toArray:function(a,c){var d=b.getMarkers(function(){var c=this;if(!c.block||c.br)return null;if(!c.trigger){var d=c.text.nodeValue,e=d.slice(0,1),f=b.getTrigger(e);if(!f)return null;c.trigger=f,c.value=d.slice(1)}var g=c.start,h=b._textarea.value,i=h.match(/^\n+/g);if(null!=i){var j=i[0].split(/\r*\n/),k=j.length-1;if(k>0)var g=c.start-k}var l={start:g,length:c.length,type:c.trigger.type,value:c.value};return a?JSON.stringify(l):l});return c?d:d.reverse()},insert:function(a,c,d){var e,f;if(c===d||void 0===d)e=b.getMarkerAt(c),f=e.start,e.insert(a,c-f,d-f);else{var g=b.getMarkersBetween(c,d),h=g.length;if(1>h)return;if(1==h)e=g[0],f=e.start,e.insert(a,c-f,d-f);else{var i=h-1,e=g[i];for(e.block&&d>e.start&&e.toTextMarker(),d-e.start>0&&e.insert("",0,d-e.start);(e=g[--i])&&i>0;)e.remove();e.block&&0===e.index&&0===c&&e.toTextMarker(),e.insert(a,c-e.start,e.length),0===c&&e.br&&e.remove()}}return b.normalize(),e},textareaInsert:function(a,c,d){var e=b._textarea,f=e.value;return e.value=f.substring(0,c)+a+f.slice(d)},normalize:function(){var a=b._overlay,c=b._textarea;a.normalize();var d=a.firstChild,e=a.lastChild,f=document.createTextNode("");e&&"BR"!==e.nodeName||a.appendChild(f),e&&e==d&&1===e.nodeType&&e.hasAttribute("data-ignore")&&a.insertBefore(f,e),a.style.height="auto",a.style.height=c.scrollHeight+"px",c.scrollTop=0,b.lengthBefore=c.value.length},lengthBefore:0,caretBefore:{start:0,end:0},caretAfter:{start:0,end:0},skipKeydown:!1,previousMarker:null,initialFocus:!0,isPasting:!1,smileyLength:0,tagToProcess:[],previousCursorPosition:0,"{textarea} focus":function(){b.initialFocus&&b.textarea().caret(b.initialCaret||0)},"{textarea} focusout":function(){b.previousCursorPosition=b.textarea().prop("selectionEnd")},"{textarea} keydown":function(c,d){if(b.initialFocus=!1,!b.skipKeydown){{b.caretBefore=c.caret()}8===d.keyCode&&a.IE<10&&b.overlay().css("opacity",0),b.skipKeydown=!0}},"{textarea} keypress":function(a,c){b.caretBefore=a.caret(),8===c.keyCode},convertHashTag:function(){var d=b.overlay().html();d=d.replace(/<span[^>]*>(#.*?)<\/span[^>]*>/g,"$1"),d=d.replace(/<br\s*[\/]?>/gi,"\n");var e=d.match(/(\s|^)(#[^\s]+[\w])/g);if(e&&e.length>0){var f=[];a.each(e,function(b,c){c=c.trim(),-1==a.inArray(c,f)&&f.push(c)}),a(f).each(function(a,b){var c=b.replace("#",""),e=c.match(/[&=\?]/g);if(!e){spanEle="<span>$1</span>";var f=new RegExp("("+b+")($|^|\\b)","gm");d=d.replace(f,spanEle)}}),b.overlay().html(d)}},convertEmoticon:function(){var d=b.overlay().html();d=d.replace(/<span[^>]*>(:.*?)<\/span[^>]*>/g,"$1"),d=d.trim(),d=d.replace(/<br\s*[\/]?>/gi,"\n");var e=d.match(/:\([^\s]+[\w]\)/g);if(e&&e.length>0){var f=[];a.each(e,function(b,c){-1==a.inArray(c,f)&&f.push(c)}),a(f).each(function(a,b){b=b.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),spanEle="<span>$1</span> ";var c=new RegExp("("+b+")($|^| |\\b)","gm");d=d.replace(c,spanEle)}),b.overlay().html(d)}},"{textarea} input":function(a){b.reflect(),b.isPasting&&(b.convertHashTag(),b.convertEmoticon(),b.isPasting=!1),a.val().length<1&&b.reset()},"{textarea} paste":function(){b.isPasting=!0},"{textarea} keyup":function(c,d){if(b.skipKeydown=!1,8===d.keyCode&&a.IE<10){var e=b.caretBefore,f=b.caretAfter=b.textarea().caret();b.insert("",f.end,e.end),b.caretBefore=f,b.overlay().css("opacity",1)}b.isPasting&&(b.isPasting=!1)},"{textarea} click":function(a){b.caretBefore=a.caret()},reflect:function(){var c=b._textarea,d=c.value,e=b.caretBefore,f=b.caretAfter=a(c).caret(),g=a.browser.opera&&f.end>f.start,h=b.getMarkerAt(e.start),i=b.lengthBefore-d.length,j=!1;if(g&&e.start!==e.end&&(e.end+=i),b.resetInput===!0&&(f.start=d.length,f.end=d.length),b.smileyLength>0){var k=b.previousCursorPosition+b.smileyLength;f.start=k,f.end=k,b.smileyLength=0}if(h){var l=b.previousMarker,m=h.block;if(l){var n=l.block,o=(l.trigger||{}).finalize;if(n&&o&&!l.finalized&&n!==m)try{l.toTextMarker()}catch(p){b.previousMarker=null}}if(!h.br&&(0===i||f.end<e.start))var q=h.start,r=h.end-i,s=f.end,t=e.start,j=q!==r;else var s=q=Math.min(e.start,f.start),t=e.end,r=f.end;var u=d.substring(q,r);j?(h.val()!==u&&h.finalized&&h.toTextMarker(),h.val(u),b.overlay().trigger("markerInsert",[h,[],u,q,r]),b.normalize()):b.insert(u,s,t),g&&(f.start=f.end),b.caretBefore=b.caretAfter}},"{overlay} markerInsert":function(c,d,e,f,g,h,i){var l,j=e.text,k=j.nodeValue;b.previousMarker=null;var m=k.charCodeAt(h-1),n=e.before&&e.before.br;if((l=b.getTrigger(g)&&(32===m||isNaN(m)))&&(0===e.index||32===m||n)){var o=k.slice(h),p=o.slice(1);i=l.wrap&&o.length>1&&32!=p.charCodeAt()?b.getStopIndex(p,l.stop)+h+1:h+1;var q=e.spawn(h,i).toBlockMarker(),p=q.val().slice(1),r=a(q.block).data("marker");r.value=p,r.trigger=l,b.previousMarker=q,b.trigger("triggerCreate",[q,l,p])}if(e.block&&!e.br)if(e.finalized){var s=e.length;s-1>i&&e.toTextMarker()}else{var t=k.slice(0,1),l=b.getTrigger(t);if(!l)return;var p=k.slice(1),h=b.getStopIndex(p,l.stop)+1,i=k.length,q=!1;i>h&&(q=e.spawn(h,i)),p=e.val().slice(1);var r=a(e.block).data("marker");r.value=p,r.trigger=l,b.previousMarker=e,b.trigger("triggerChange",[e,q,l,p])}},"{overlay} markerExit":function(a,c,d,e,f){var j=d.trigger;if(j){var k=j.allowSpace||d.allowSpace,l=d.val();k||d.val()!==j.key||d.toTextMarker(),b.trigger("triggerExit",[d,f,j,l])}}}}),a.template("mentions/menu",'<div class="mentions-autocomplete" data-mentions-autocomplete><b><b></b></b><div class="mentions-autocomplete-inner" data-mentions-autocomplete-viewport><div class="mentions-autocomplete-loading" data-mentions-autocomplete-loading data-mentions-autocomplete-close></div><div class="mentions-autocomplete-empty" data-mentions-autocomplete-empty></div><div class="mentions-autocomplete-search" data-mentions-autocomplete-search></div><ul class="mentions-menu" data-mentions-menu></ul></div></div>'),a.template("mentions/menuItem",'<li class="mentions-menuItem" data-mentions-menuItem>[%== html %]</li>'),a.template("mentions/loadingHint",'<div class="mentions-autocomplete-loading-indicator"><div class="o-loader o-loader--top o-loader--sm is-active"></div></div>'),a.template("mentions/searchHint",'<span class="mentions-autocomplete-search-hint">Type a keyword to begin.</span>'),a.template("mentions/emptyHint",'<span class="mentions-autocomplete-empty-text">No items found.</span>'),a.Controller("Mentions.Autocomplete",{defaultOptions:{view:{menu:"mentions/menu",menuItem:"mentions/menuItem",searchHint:"mentions/searchHint",loadingHint:"mentions/loadingHint",emptyHint:"mentions/emptyHint"},id:"",component:"",modifier:"",shadow:!1,sticky:!1,animation:!1,query:{data:null,cache:!0,minLength:1,limit:10,highlight:!0,caseSensitive:!1,exclusive:!1,searchHint:!1,loadingHint:!1,emptyHint:!1,renderAll:!1},position:{my:"left top",at:"left bottom",collision:"none"},size:{width:"auto",height:"auto"},"{menu}":"[data-mentions-menu]","{menuItem}":"[data-mentions-menuItem]","{viewport}":"[data-mentions-autocomplete-viewport]","{loadingHint}":"[data-mentions-autocomplete-loading]","{emptyHint}":"[data-mentions-autocomplete-empty]","{searchHint}":"[data-mentions-autocomplete-search]","{closeButton}":"[data-mentions-autocomplete-close]"}},function(b,c,d){return{init:function(){setTimeout(function(){if(b.element.data(b.Class.fullName)){var e=b.mentions;b.uid=a.uid(),e.autocomplete=b,e.pluginInstances.autocomplete=b,c.position.of||(c.position.of=b.mentions.element),b.defaultSearchHint=b.view.searchHint().toHTML(),b.defaultEmptyHint=b.view.emptyHint().toHTML(),b.defaultLoadingHint=b.view.loadingHint().toHTML(),b.element.detach()}else{b.destroy();{b.view.menu().attr("id",c.id).addClass(c.component).addClass(c.modifier).addClass(c.shadow?"has-shadow":"").addClass(c.animation?"has-animation":"").addClass(c.sticky?"is-sticky":"").appendTo("body").data(b.Class.fullName,!0).addController(b.Class,c)}}},50)},setLayout:function(){if(!b.hidden){var c=b.options,d=c.size,e=b.mentions.element.outerWidth(),f="auto";a.isFunction(d.width)&&(e=d.width(e)),a.isFunction(d.height)&&(f=d.height(f)),b.element.css({opacity:1,width:e}).position(b.options.position),setTimeout(function(){b.viewport().addClass("active")},1)}},"{window} resize":a.debounce(function(){b.element.css("opacity",0),b.setLayout()},250),"{window} scroll":a.debounce(function(){b.element.css("opacity",0),b.setLayout()},250),"{window} dialogTransitionStart":function(){b.hidden=!0,b.element.css("opacity",0)},"{window} dialogTransitionEnd":function(){b.hidden=!1,b.setLayout()},currentMarker:null,"{mentions} triggerCreate":function(a,c,d,e,f){b.populate(d,e,f),b.currentMarker=d},"{mentions} triggerChange":function(a,c,d,e,f,g){b.populate(d,f,g),b.currentMarker=d},"{mentions} triggerExit":function(){var h=b.activeQuery;h&&(h.aborted=!0),b.hide()},"{mentions.block} triggerDestroy":function(){b.hide()},"{mentions} triggerClear":function(){b.hide()},hidden:!0,show:function(c){clearTimeout(b.sleep),b.element.appendTo("body").show(),b.hidden=!1,b.viewport().removeClass("active"),b.setLayout();var e=a(document),f="click.mentions."+b.uid;e.off(f).on(f,function(c){var g=a(c.target).parents().andSelf();g.filter(d).length>0||(e.off(f),b.hide())}),c&&(b.sleep=setTimeout(function(){b.hide()},c))},hide:function(){b.element.hide();var a=b.menuItem(),c=a.filter(".active");c.length>0&&(b.lastItem={keyword:"",item:c.data("item")}),b.viewport().removeClass("active"),a.removeClass("active"),b.render.reset(),b.hidden=!0,clearTimeout(b.sleep),b.sleep=setTimeout(function(){b.element.detach()},3e3)},query:function(c){if(c){var d=a.extend({},b.options.query,a.isPlainObject(c)?c:{data:c}),e=d.data;if(e){if(a.isUrl(e)){var f=e;d.lookup=function(){return a.ajax(f+d.keyword)}}if(a.isFunction(e)){var g=e;d.lookup=function(){return g.call(b,d.keyword)}}if(a.isArray(e)){var h=e;d.lookup=function(){var b=a.Deferred(),c=d.keyword.toLowerCase();return setTimeout(function(){var d=a.grep(h,function(a){return a.title.toLowerCase().indexOf(c)>-1});b.resolve(d)},0),b}}return d}}},tasks:{},delayTask:null,activeQuery:null,renderAllItems:function(c,d,e,f){var g=b.mentions,h=b,i=b.element,j=b.menu(),k=c.keyword;j.empty(),a.each(c.data,function(d,e){if(g.trigger("menuCreateItem",[e,c,h,g]),a.isPlainObject(e)&&!e.discard){var f=e.menuHtml||e.title;b.view.menuItem({html:f}).data("item",e).appendTo(j)}}),j.data("keyword",k);var l=b.menuItem();if(g.trigger("menuCreate",[j,l,c,h,g]),l.filter(":not(.hidden)").length<1&&(i.addClass("empty"),!c.emptyHint))return b.hide();c.exclusive&&b.menuItem(":not(.hidden):first").addClass("active"),g.trigger("renderMenu",[j,c,h,g]),b.show(),b.activeQuery=c,c.keyword=f,c.trigger=e,c.marker=d,b.trigger("queryPrepare",[c]);var f=c.keyword,m=c.id=e.key+"|"+c.caseSensitive?f:f.toLowerCase(),n=b.tasks,o=c.task=n[m],p=function(){var a=b.trigger("queryBeforeStart",[c]);a.isDefaultPrevented()||(o=n[m]=c.task=c.lookup(),b.trigger("queryStart",[c]))};clearTimeout(b.delayTask),b.delayTask=setTimeout(p,250)},populate:function(c,d,e){var f=b.activeQuery;f&&(f.aborted=!0);var f=b.query(d.query);if(f){if(f.renderAll&&""===e)return b.renderAllItems(f,c,d,e),void 0;b.activeQuery=f,f.keyword=e,f.trigger=d,f.marker=c,b.trigger("queryPrepare",[f]);var e=f.keyword;if(""===e||e.length<f.minLength){var g=f.searchHint;return g?(b.searchHint().html(a.isString(g)?g:b.defaultSearchHint),b.element.addClass("search"),b.show()):b.hide(),void 0}var h=f.id=d.key+"|"+f.caseSensitive?e:e.toLowerCase(),i=b.tasks,j=f.task=i[h],k=!a.isDeferred(j)||!f.cache,l=function(){var a=b.trigger("queryBeforeStart",[f]);a.isDefaultPrevented()||((k||!k&&"rejected"==j.state())&&(j=i[h]=f.task=f.lookup()),j.done(b.render(function(a){return[a,f]})),b.trigger("queryStart",[f]))};k?(clearTimeout(b.delayTask),b.delayTask=setTimeout(l,250)):l()}},"{self} queryPrepare":function(a,c,d){a.removeClass("loading empty search"),d.loadingHint&&b.hide()},"{self} queryBeforeStart":function(c,d,e){var f=e.loadingHint;f&&(b.loadingHint().html(a.isString(f)?f:b.defaultLoadingHint),c.addClass("loading"),b.show())},"{self} queryStart":function(a,c,d){d.task.fail(function(){b.hide()}).always(function(){a.removeClass("loading")})},render:a.Enqueue(function(c,d){if(d.aborted)return b.hide(),void 0;a.isArray(c)||(c=[]);var e=b.mentions,f=b,g=b.element,h=b.menu(),i=d.keyword;if(c.length<1){var j=d.emptyHint;return j?(b.emptyHint().html(a.isString(j)?j:b.defaultEmptyHint),h.empty(),g.addClass("empty"),b.show(2e3)):b.hide(),e.trigger("menuRender",[h,d,f,e]),void 0}g.removeClass("empty"),d.cache&&h.data("keyword")===i||(h.empty(),a.each(c,function(c,g){if(e.trigger("menuCreateItem",[g,d,f,e]),a.isPlainObject(g)&&!g.discard){var i=g.menuHtml||g.title;b.view.menuItem({html:i}).data("item",g).appendTo(h)}}),h.data("keyword",i));var k=b.menuItem();return e.trigger("menuCreate",[h,k,d,f,e]),k.filter(":not(.hidden)").length<1&&(g.addClass("empty"),!d.emptyHint)?b.hide():(d.exclusive&&b.menuItem(":not(.hidden):first").addClass("active"),e.trigger("renderMenu",[h,d,f,e]),b.show(),void 0)}),"{mentions.textarea} keydown":function(a,c){clearTimeout(b.sleep);var d=b.menuItem(".active:not(.hidden)");switch(d.length<1&&(d=!1),c.keyCode){case h.UP:b.menuItem().removeClass("active"),d?d.prev(b.menuItem.selector+":not(.hidden)").addClass("active"):b.menuItem(":not(.hidden):last").addClass("active"),b.hidden||c.preventDefault();break;case h.DOWN:b.menuItem().removeClass("active"),d?d.next(b.menuItem.selector+":not(.hidden)").addClass("active"):b.menuItem(":not(.hidden):first").addClass("active"),b.hidden||c.preventDefault();break;case h.ESCAPE:b.hide();break;case h.ENTER:if(!b.hidden&&d){var e=d.data("item");b.use(e),c.preventDefault()}}var d=b.menuItem(".active:not(.hidden)");b.hidden||b.viewport().scrollIntoView(d)},"{menuItem} mouseup":function(a){b.hide();var c=a.data("item");b.use(c),setTimeout(function(){b.mentions.textarea().focus()},150)},use:function(a){var c=b.activeQuery;if(c){var d=c.marker,e=a.title;d.text.nodeValue=e;var f=a;c.use&&(f=c.use(a)),d.finalize(f),b.mentions.textareaInsert(e,d.start,d.end),b.mentions.textarea().caret(d.start+e.length),b.mentions.normalize(),b.hidden=!0,b.hide(),b.addSpace()}},addSpace:function(){var a=b.mentions.getMarkers(),c=a[a.length-1],d=c.spawn(),e=" ";d.val(e),b.mentions.textareaInsert(e,d.start,d.end),b.mentions.textarea().caret(d.start+e.length),b.mentions.normalize()},"{menuItem} mouseover":function(a){b.menuItem().removeClass("active"),a.addClass("active")},"{menuItem} mouseout":function(){b.menuItem().removeClass("active")},"{closeButton} click":function(){b.hide()},"{mentions} destroyed":function(){b.element.remove()}}})};c(),b.resolveWith(c)};FD40.module("mentions",a)}();
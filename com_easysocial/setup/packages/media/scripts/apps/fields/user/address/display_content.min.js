EasySocial.module("apps/fields/user/address/display_content",function(a){var b=this;EasySocial.require().library("gmaps","leaflet").done(function(){EasySocial.Controller("Field.Address.Display",{defaultOptions:{latitude:null,longitude:null,ratio:1,mapElementId:"map","{base}":"[data-location-base]","{map}":"[data-location-map]","{mapImage}":"[data-location-map-image]"}},function(b){return{init:function(){b.options.mapElementId&&(b.mapElementId=b.options.mapElementId);var a=b.map();b.options.latitude=a.data("latitude"),b.options.longitude=a.data("longitude"),b.options.provider=a.data("location-provider"),b.setLayout()},"{window} resize":a.debounce(function(){b.setLayout()},250),navigate:function(c,d){if(!b.options.staticMap&&"osm"==b.options.provider)return b.navigateDynamic(c,d),b.base().addClass("has-location"),b.base().removeClass("is-loading"),void 0;{var e=b.mapImage();Math.floor(e.width()),Math.floor(e.height())}if("osm"==b.options.provider)var h="//maps.wikimedia.org/img/osm-intl,15,"+c+","+d+",600x300.png";else var h=a.GMaps.staticMapURL({size:[1280,1280],lat:c,lng:d,sensor:!0,scale:2,zoom:b.options.zoom,markers:[{lat:c,lng:d}]});var h=h.replace(/http\:|https\:/,"");a.Image.get(h).done(function(){e.css({backgroundImage:a.cssUrl(h),backgroundSize:"cover",backgroundPosition:"center center"}),b.base().addClass("has-location"),b.map().addClass("is-maps has-data")}).always(function(){b.base().removeClass("is-loading")})},navigateDynamic:function(a,c){b.osm=L.map(b.mapElementId,{zoom:12}),b.osm.fitWorld(),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(b.osm);var d={lat:parseFloat(a),lng:parseFloat(c)};b.osm.flyTo(d,13,{duration:3}),marker=L.marker(d).addTo(b.osm)},setLayout:function(){setTimeout(function(){b.options.latitude&&b.options.longitude&&b.navigate(b.options.latitude,b.options.longitude)},1)},"{self} onShow":function(){b.setLayout()}}}),b.resolve()})});
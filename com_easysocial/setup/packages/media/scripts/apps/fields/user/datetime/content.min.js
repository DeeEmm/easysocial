EasySocial.module("apps/fields/user/datetime/content",function(){var b=this;EasySocial.require().library("datetimepicker","chosen","moment/"+EasySocial.options.momentLang).done(function(a){EasySocial.Controller("Field.Datetime",{defaultOptions:{required:!1,calendarDateFormat:null,yearfrom:null,yearto:null,date:null,lang:null,allowTime:!1,allowTimezone:!1,ageLimit:null,calendarLanguage:"english","{field}":"[data-field-datetime]","{date}":"[data-field-datetime-select]","{dateValue}":"[data-field-datetime-value]","{timezone}":"[data-field-datetime-timezone]","{form}":"[data-field-datetime-form]","{icon}":"[data-field-datetime-icon]","{clearButton}":"[data-clear]"}},function(b,c){return{init:function(){if(b.options.yearfrom=b.options.yearfrom||1930,b.options.yearto=a.isEmpty(b.options.yearto)?(new Date).getFullYear()+100:parseInt(b.options.yearto)+1,b.date()._datetimepicker({component:"es",format:b.options.calendarDateFormat,minDate:b.options.yearfrom+"-01-01",maxDate:b.options.yearto+"-12-31",icons:{time:"far fa-clock",date:"fa fa-calendar",up:"fa fa-chevron-up",down:"fa fa-chevron-down"},sideBySide:!1,pickTime:b.options.allowTime,useCurrent:!1,language:"english"==b.options.calendarLanguage?"en-gb":EasySocial.options.momentLang,dow:b.options.dow}),b.options.date=b.dateValue().val(),!a.isEmpty(b.options.date)){var c=a.moment(b.options.date);b.datetimepicker("setDate",c)}b.options.allowTimezone&&(b.timezone().on("chosen:ready",function(b){var c=a(b.currentTarget.nextSibling);a(c).addClass("chosen-container-single--es-timezone")}),b.timezone().chosen({search_contains:!0}))},initErrorData:function(){var a=b.field().htmlData();c.error=a.error||{}},"{self} onRender":function(){b.initErrorData()},"{icon} click":function(){b.datetimepicker("show")},"{date} dp.change":function(a,c){b.setDateValue(c.date.toDate()),b.form().addClass("has-datetime"),b.options.allowTime||b.date().blur(),b.validateCalendar()},datetimepicker:function(a,c){return b.date().data("DateTimePicker")[a](c)},setDateValue:function(a){b.dateValue().val(a.getFullYear()+"-"+("00"+(a.getMonth()+1)).slice(-2)+"-"+("00"+a.getDate()).slice(-2)+" "+("00"+a.getHours()).slice(-2)+":"+("00"+a.getMinutes()).slice(-2)+":"+("00"+a.getSeconds()).slice(-2))},"{date} blur":function(){b.validateCalendar()},validateCalendar:function(){return b.clearError(),b.options.required&&a.isEmpty(b.dateValue().val())?(c.error||b.initErrorData(),b.raiseError(c.error.empty),!1):b.validateAge().done(function(){b.clearError()}).fail(function(a){b.raiseError(a)})},validateAge:function(){return EasySocial.ajax("fields/user/birthday/isValid",{id:0,value:b.dateValue().val(),age_limit:c.ageLimit,year_from:c.yearfrom,year_to:c.yearto})},raiseError:function(a){b.trigger("error",[a])},clearError:function(){b.trigger("clear")},"{self} onSubmit":function(a,c,d){d.push(b.validateCalendar())},"{clearButton} click":function(){b.form().removeClass("has-datetime"),b.datetimepicker("setValue",new a.moment),b.date().val(""),b.dateValue().val("")}}}),b.resolve()})});